<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact Hub - Smart Contact Manager</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; overflow-x: hidden; }
        
        /* PPT-Style Splash Popup */
        #splash { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle, #0f0f23 0%, #000 100%); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 10000; transition: opacity 1s ease-out; }
        #splash.hidden { opacity: 0; pointer-events: none; }
        .particles { position: absolute; width: 100%; height: 100%; overflow: hidden; }
        .particle { position: absolute; background: #fff; border-radius: 50%; animation: float 6s ease-in-out infinite; opacity: 0.6; }
        @keyframes float { 0%, 100% { transform: translateY(0) rotate(0deg); } 50% { transform: translateY(-20px) rotate(180deg); } }
        .title { font-size: clamp(4rem, 15vw, 10rem); background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #f9ca24, #f0932b); background-size: 400% 400%; -webkit-background-clip: text; -webkit-text-fill-color: transparent; animation: glow 2s ease-in-out infinite alternate, gradient 3s ease infinite; text-shadow: 0 0 20px rgba(255,255,255,0.5); position: relative; }
        @keyframes glow { from { filter: drop-shadow(0 0 20px #ff6b6b); } to { filter: drop-shadow(0 0 40px #4ecdc4); } }
        @keyframes gradient { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .subtitle { color: #fff; font-size: 1.5rem; margin-top: 1rem; animation: slideIn 1s ease-out 1s both; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        .enter-btn { background: linear-gradient(45deg, #ff6b6b, #4ecdc4); color: white; border: none; padding: 15px 40px; font-size: 1.2rem; border-radius: 50px; cursor: pointer; margin-top: 2rem; box-shadow: 0 10px 30px rgba(255,107,107,0.4); transition: all 0.3s ease; animation: bounce 2s infinite; }
        .enter-btn:hover { transform: scale(1.05); box-shadow: 0 15px 40px rgba(255,107,107,0.6); }
        @keyframes bounce { 0%, 20%, 50%, 80%, 100% { transform: translateY(0); } 40% { transform: translateY(-10px); } 60% { transform: translateY(-5px); } }

        /* Login Page */
        #login-page { display: none; min-height: 100vh; justify-content: center; align-items: center; padding: 2rem; }
        .login-card { background: rgba(255,255,255,0.95); backdrop-filter: blur(20px); padding: 3rem; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); width: 100%; max-width: 400px; text-align: center; }
        .login-card h2 { color: #333; margin-bottom: 2rem; font-size: 2rem; }
        input { width: 100%; padding: 15px; margin: 1rem 0; border: 2px solid #eee; border-radius: 10px; font-size: 1rem; transition: border 0.3s; }
        input:focus { outline: none; border-color: #667eea; }
        .login-btn { background: linear-gradient(45deg, #667eea, #764ba2); color: white; border: none; padding: 15px; width: 100%; border-radius: 10px; font-size: 1.1rem; cursor: pointer; transition: transform 0.3s; }
        .login-btn:hover { transform: translateY(-2px); }

        /* Main App */
        #app { display: none; min-height: 100vh; }
        .header { background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 20px rgba(0,0,0,0.1); }
        .header h1 { color: #333; font-size: 1.8rem; }
        .controls { display: flex; gap: 1rem; align-items: center; }
        #search, #voice-btn { padding: 10px 20px; border: 2px solid #667eea; border-radius: 25px; background: white; cursor: pointer; transition: all 0.3s; }
        #voice-btn.active { background: #ff6b6b; color: white; }
        #add-contact { background: linear-gradient(45deg, #4ecdc4, #44a08d); color: white; border: none; padding: 10px 20px; border-radius: 25px; cursor: pointer; font-size: 1rem; }
        .contacts-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 2rem; padding: 2rem; max-width: 1400px; margin: 0 auto; }
        .contact-card { background: white; border-radius: 20px; padding: 1.5rem; box-shadow: 0 10px 40px rgba(0,0,0,0.1); transition: transform 0.3s, box-shadow 0.3s; position: relative; overflow: hidden; }
        .contact-card:hover { transform: translateY(-10px); box-shadow: 0 20px 60px rgba(0,0,0,0.2); }
        .contact-avatar { width: 60px; height: 60px; border-radius: 50%; background: linear-gradient(45deg, #667eea, #764ba2); color: white; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.2rem; margin-bottom: 1rem; }
        .contact-name { font-size: 1.4rem; font-weight: bold; color: #333; margin-bottom: 0.5rem; }
        .contact-phone { color: #666; margin-bottom: 1rem; }
        .contact-actions { display: flex; gap: 0.5rem; margin-top: 1rem; }
        .action-btn { padding: 8px 12px; border: none; border-radius: 50%; cursor: pointer; font-size: 1rem; transition: transform 0.2s; }
        .call-btn { background: #4ecdc4; color: white; }
        .msg-btn { background: #f9ca24; color: white; }
        .edit-btn { background: #667eea; color: white; }
        .delete-btn { background: #ff6b6b; color: white; }
        .fav-btn { position: absolute; top: 15px; right: 15px; background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #ffd700; }
        .fav-btn.active { color: #ff6b6b; }
        .group-tag { background: #e0e0e0; padding: 4px 12px; border-radius: 20px; font-size: 0.8rem; margin-top: 0.5rem; display: inline-block; }
        .location-btn { background: #45b7d1; color: white; margin-top: 0.5rem; width: 100%; border-radius: 10px; padding: 8px; border: none; cursor: pointer; }
        #modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; justify-content: center; align-items: center; }
        .modal-content { background: white; padding: 2rem; border-radius: 20px; width: 90%; max-width: 500px; max-height: 80vh; overflow-y: auto; }
        .close { position: absolute; top: 20px; right: 30px; font-size: 2rem; cursor: pointer; color: #999; }
        select, textarea { width: 100%; padding: 12px; margin: 0.5rem 0; border: 2px solid #eee; border-radius: 10px; }
        .reminder { background: #fff3cd; border-left: 4px solid #ffc107; padding: 10px; margin-top: 0.5rem; border-radius: 5px; font-size: 0.9rem; }
        @media (max-width: 768px) { .contacts-grid { grid-template-columns: 1fr; padding: 1rem; } .header { flex-direction: column; gap: 1rem; } }
    </style>
</head>
<body>
    <!-- PPT-Style Splash Popup -->
    <div id="splash">
        <div class="particles" id="particles"></div>
        <div class="title" id="title">Contact Hub</div>
        <div class="subtitle">Your Smart Contact Manager</div>
        <button class="enter-btn" onclick="enterApp()"><i class="fas fa-arrow-right"></i> Enter</button>
    </div>

    <!-- Login Page -->
    <div id="login-page">
        <div class="login-card">
            <h2><i class="fas fa-lock"></i> Welcome Back</h2>
            <input type="text" id="username" placeholder="Username" value="admin">
            <input type="password" id="password" placeholder="Password" value="123">
            <button class="login-btn" onclick="login()"><i class="fas fa-sign-in-alt"></i> Login to Contact Hub</button>
        </div>
    </div>

    <!-- Main App -->
    <div id="app">
        <div class="header">
            <h1><i class="fas fa-address-book"></i> Contact Hub</h1>
            <div class="controls">
                <input type="text" id="search" placeholder="üîç Search contacts..." oninput="searchContacts()">
                <button id="voice-btn" onclick="toggleVoiceSearch()"><i class="fas fa-microphone"></i></button>
                <button id="add-contact" onclick="openModal('add')"><i class="fas fa-plus"></i> Add Contact</button>
            </div>
        </div>
        <div class="contacts-grid" id="contacts-grid"></div>
    </div>

    <!-- Modal for Add/Edit -->
    <div id="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2 id="modal-title">Add Contact</h2>
            <form id="contact-form">
                <input type="file" id="avatar" accept="image/*" onchange="previewAvatar()">
                <div class="contact-avatar" id="avatar-preview">üë§</div>
                <input type="text" id="name" placeholder="Name *" required>
                <input type="tel" id="phone" placeholder="Phone *">
                <input type="email" id="email" placeholder="Email">
                <input type="date" id="birthday" placeholder="Birthday">
                <input type="text" id="group" placeholder="Group (e.g. Family)">
                <textarea id="notes" placeholder="Notes"></textarea>
                <button type="submit" class="login-btn" style="margin-top:1rem;">Save Contact</button>
            </form>
        </div>
    </div>

    <script>
        // Initialize app
        let contacts = JSON.parse(localStorage.getItem('contacts')) || [];
        let editingId = null;
        let recognition = null;
        let watchId = null;
        createParticles();

        // Splash to Login
        function enterApp() {
            document.getElementById('splash').classList.add('hidden');
            setTimeout(() => {
                document.getElementById('splash').style.display = 'none';
                document.getElementById('login-page').style.display = 'flex';
            }, 1000);
        }

        // Login (simple demo)
        function login() {
            document.getElementById('login-page').style.display = 'none';
            document.getElementById('app').style.display = 'block';
            renderContacts();
            checkReminders();
            checkDuplicates();
        }

        // Particles for splash
        function createParticles() {
            const particles = document.getElementById('particles');
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 6 + 's';
                particle.style.animationDuration = (Math.random() * 3 + 3) + 's';
                particle.style.width = particle.style.height = (Math.random() * 4 + 2) + 'px';
                particles.appendChild(particle);
            }
        }

        // Voice Search (Web Speech API)
        function toggleVoiceSearch() {
            const btn = document.getElementById('voice-btn');
            if (!('webkitSpeechRecognition' in window)) {
                alert('Voice search not supported in this browser');
                return;
            }
            if (btn.classList.contains('active')) {
                if (recognition) recognition.stop();
                btn.classList.remove('active');
                btn.innerHTML = '<i class="fas fa-microphone"></i>';
            } else {
                recognition = new webkitSpeechRecognition();
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = 'en-US';
                recognition.onresult = (e) => {
                    const query = e.results[0][0].transcript.toLowerCase();
                    document.getElementById('search').value = query;
                    searchContacts();
                };
                recognition.onerror = () => toggleVoiceSearch();
                recognition.start();
                btn.classList.add('active');
                btn.innerHTML = '<i class="fas fa-microphone-slash"></i>';
            }
        }

        // Contact Operations
        document.getElementById('contact-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const contact = {
                id: editingId || Date.now(),
                name: document.getElementById('name').value,
                phone: document.getElementById('phone').value,
                email: document.getElementById('email').value,
                birthday: document.getElementById('birthday').value,
                group: document.getElementById('group').value || 'Uncategorized',
                notes: document.getElementById('notes').value,
                favorite: false,
                avatar: document.getElementById('avatar').files[0] ? URL.createObjectURL(document.getElementById('avatar').files[0]) : null,
                location: null
            };
            if (editingId) {
                const index = contacts.findIndex(c => c.id === editingId);
                contacts[index] = contact;
            } else {
                contacts.unshift(contact);
            }
            localStorage.setItem('contacts', JSON.stringify(contacts));
            closeModal();
            renderContacts();
            checkDuplicates();
        });

        function renderContacts(filtered = contacts) {
            const grid = document.getElementById('contacts-grid');
            // Alphabetical sorting
            filtered.sort((a, b) => a.name.localeCompare(b.name));
            grid.innerHTML = filtered.map(contact => `
                <div class="contact-card">
                    <button class="fav-btn" onclick="toggleFavorite(${contact.id})">${contact.favorite ? '‚ù§Ô∏è' : 'ü§ç'}</button>
                    <div class="contact-avatar">${contact.avatar ? `<img src="${contact.avatar}" style="width:100%;height:100%;border-radius:50%;object-fit:cover;">` : contact.name[0]}</div>
                    <div class="contact-name">${contact.name}</div>
                    <div class="contact-phone">${contact.phone || 'No phone'}</div>
                    ${contact.email ? `<div>${contact.email}</div>` : ''}
                    <span class="group-tag">${contact.group}</span>
                    ${contact.birthday && isUpcomingBirthday(contact.birthday) ? `<div class="reminder">üéâ Birthday soon!</div>` : ''}
                    <div class="contact-actions">
                        <button class="action-btn call-btn" onclick="callContact('${contact.phone}')"><i class="fas fa-phone"></i></button>
                        <button class="action-btn msg-btn" onclick="msgContact('${contact.phone}')"><i class="fas fa-sms"></i></button>
                        <button class="action-btn edit-btn" onclick="editContact(${contact.id})"><i class="fas fa-edit"></i></button>
                        <button class="action-btn delete-btn" onclick="deleteContact(${contact.id})"><i class="fas fa-trash"></i></button>
                    </div>
                    ${contact.phone ? `<button class="location-btn" onclick="trackLocation(${contact.id})">üìç Track Location</button>` : ''}
                </div>
            `).join('');
        }

        function searchContacts() {
            const query = document.getElementById('search').value.toLowerCase();
            const filtered = contacts.filter(c => 
                c.name.toLowerCase().includes(query) || 
                c.phone?.includes(query) || 
                c.email?.toLowerCase().includes(query) ||
                c.group.toLowerCase().includes(query)
            );
            renderContacts(filtered);
        }

        function openModal(mode, id = null) {
            editingId = id;
            document.getElementById('modal-title').textContent = mode === 'add' ? 'Add Contact' : 'Edit Contact';
            if (id) {
                const contact = contacts.find(c => c.id === id);
                document.getElementById('name').value = contact.name;
                document.getElementById('phone').value = contact.phone;
                document.getElementById('email').value = contact.email;
                document.getElementById('birthday').value = contact.birthday;
                document.getElementById('group').value = contact.group;
                document.getElementById('notes').value = contact.notes;
            }
            document.getElementById('modal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
            document.getElementById('contact-form').reset();
            editingId = null;
            document.getElementById('avatar-preview').textContent = 'üë§';
        }

        function toggleFavorite(id) {
            const contact = contacts.find(c => c.id === id);
            contact.favorite = !contact.favorite;
            localStorage.setItem('contacts', JSON.stringify(contacts));
            renderContacts();
        }

        function deleteContact(id) {
            if (confirm('Delete this contact?')) {
                contacts = contacts.filter(c => c.id !== id);
                localStorage.setItem('contacts', JSON.stringify(contacts));
                renderContacts();
            }
        }

        function editContact(id) {
            openModal('edit', id);
        }

        function callContact(phone) {
            window.open(`tel:${phone}`, '_blank');
        }

        function msgContact(phone) {
            window.open(`sms:${phone}`, '_blank');
        }

        // Live Location Tracking
        function trackLocation(id) {
            if (!navigator.geolocation) return alert('Geolocation not supported');
            if (watchId) navigator.geolocation.clearWatch(watchId);
            watchId = navigator.geolocation.watchPosition((pos) => {
                const contact = contacts.find(c => c.id === id);
                contact.location = { lat: pos.coords.latitude, lng: pos.coords.longitude };
                localStorage.setItem('contacts', JSON.stringify(contacts));
                alert(`Location updated: ${contact.location.lat.toFixed(4)}, ${contact.location.lng.toFixed(4)}`);
            }, () => alert('Location access denied'), { enableHighAccuracy: true });
        }

        // Smart Features
        function checkDuplicates() {
            const dups = [];
            for (let i = 0; i < contacts.length; i++) {
                for (let j = i + 1; j < contacts.length; j++) {
                    if (contacts[i].phone === contacts[j].phone && contacts[i].name.toLowerCase() === contacts[j].name.toLowerCase()) {
                        dups.push([contacts[i], contacts[j]]);
                    }
                }
            }
            if (dups.length > 0) alert(`Found ${dups.length} duplicate(s). Use edit to merge manually.`);
        }

        function isUpcomingBirthday(bday) {
            const today = new Date();
            const bdayDate = new Date(today.getFullYear(), new Date(bday).getMonth(), new Date(bday).getDate());
            const diff = bdayDate - today;
            return diff > 0 && diff < 7 * 24 * 60 * 60 * 1000; // Within 7 days
        }

        function checkReminders() {
            contacts.forEach(contact => {
                if (contact.birthday && isUpcomingBirthday(contact.birthday)) {
                    // Notification (requires user permission)
                    if (Notification.permission === 'granted') {
                        new Notification(`Birthday reminder: ${contact.name}`);
                    }
                }
            });
        }

        // Auto-favorite frequent contacts (demo: first 3 calls)
        // In production, track call history in localStorage

        // Groups: Filter by group in search (already implemented)

        // Init
        Notification.requestPermission();
    </script>
</body>
</html>